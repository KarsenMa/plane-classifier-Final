<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>integration_test API documentation</title>
<meta name="description" content="Plane Classifier Integration Testing â€¦">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>integration_test</code></h1>
</header>
<section id="section-intro">
<p>Plane Classifier Integration Testing</p>
<p>This module performs integration testing for the Plane Classifier project by:
1. Loading the ground truth data from a CSV file
2. Selecting random image and video files from the testing directories
3. Running predictions on these files using both the custom and FGVC models
4. Comparing the predictions with ground truth data
5. Generating a test results file with detailed outputs</p>
<p>The test evaluates model accuracy considering both exact matches and
class-level matches where subclass details might differ.</p>
<p>Author: Plane Classifier Team
Date: May 1, 2025</p>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="integration_test.test_models"><code class="name flex">
<span>def <span class="ident">test_models</span></span>(<span>)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_models():
    &#34;&#34;&#34;
    Run integration tests on plane classification models.
    
    This function loads both classification models and runs predictions on randomly
    selected test files, comparing the results with ground truth data. It generates
    a &#39;test_results.txt&#39; file containing detailed information about each prediction.
    
    The testing process includes:
    - Loading ground truth data from CSV
    - Randomly selecting up to 10 image/video files
    - Running predictions with both YOLO models
    - Evaluating prediction accuracy
    
    Returns:
        None: Results are written to &#39;test_results.txt&#39;
    &#34;&#34;&#34;
    # Load ground truth
    gt_path = Path(&#34;Testing_Files/ground_truth.csv&#34;)
    ground_truth = {}
    with open(gt_path, newline=&#39;&#39;, encoding=&#39;utf-8&#39;) as csvfile:
        reader = csv.DictReader(csvfile)
        for row in reader:
            ground_truth[row[&#39;filename&#39;]] = row[&#39;class&#39;]

    # Get all image and video files
    photo_dir = Path(&#34;Testing_Files/Photos&#34;)
    video_dir = Path(&#34;Testing_Files/Videos&#34;)
    all_files = []
    for ext in (&#39;*.jpg&#39;, &#39;*.jpeg&#39;, &#39;*.png&#39;):
        all_files.extend(list(photo_dir.rglob(ext)))
    for ext in (&#39;*.mp4&#39;, &#39;*.avi&#39;, &#39;*.mov&#39;, &#39;*.wmv&#39;):
        all_files.extend(list(video_dir.rglob(ext)))

    # Randomly select up to 10 files
    sampled_files = random.sample(all_files, min(10, len(all_files)))

    # Load models
    custom_model = YOLO(&#34;custom.pt&#34;)
    fgvc_model = YOLO(&#34;fgvc.pt&#34;)

    correct = 0
    total = 0
    with open(&#39;test_results.txt&#39;, &#39;w&#39;) as f:
        f.write(&#34;Integration Test Results\n======================\n\n&#34;)
        for file_path in sampled_files:
            fname = file_path.name
            gt_class = ground_truth.get(fname, &#34;&#34;)
            f.write(f&#34;\nTesting file: {fname}\n-----------------------\n&#34;)
            try:
                # Classification prediction
                fgvc_results = fgvc_model.predict(str(file_path), verbose=False)[0]
                if fgvc_results and fgvc_results.probs is not None:
                    pred_id = int(fgvc_results.probs.top1)
                    pred_class = fgvc_model.names[pred_id]
                    conf = float(fgvc_results.probs.data[pred_id].item())
                    f.write(f&#34;Predicted: {pred_class} ({conf*100:.1f}%) | Ground Truth: {gt_class}\n&#34;)
                    if gt_class and pred_class == gt_class:
                        print(&#34;Correct&#34;)
                        correct += 1
                    elif gt_class and pred_class[:4] == gt_class[:4]:
                        print(&#34;Correct Class, missed subclass&#34;)
                        correct += 1
                else:
                    pred_class = &#34;&#34;
                    f.write(&#34;No classification result\n&#34;)
                total += 1 if gt_class else 0
            except Exception as e:
                f.write(f&#34;Error processing file: {str(e)}\n&#34;)
        # Print summary
        # accuracy = (correct / total) * 100 if total else 0
        # f.write(f&#34;\nSuccess Rate: {correct}/{total} ({accuracy:.2f}%)\n&#34;)
        # print(f&#34;Success Rate: {correct}/{total} ({accuracy:.2f}%)&#34;)</code></pre>
</details>
<div class="desc"><p>Run integration tests on plane classification models.</p>
<p>This function loads both classification models and runs predictions on randomly
selected test files, comparing the results with ground truth data. It generates
a 'test_results.txt' file containing detailed information about each prediction.</p>
<p>The testing process includes:
- Loading ground truth data from CSV
- Randomly selecting up to 10 image/video files
- Running predictions with both YOLO models
- Evaluating prediction accuracy</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>None</code></dt>
<dd>Results are written to 'test_results.txt'</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="integration_test.test_models" href="#integration_test.test_models">test_models</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
